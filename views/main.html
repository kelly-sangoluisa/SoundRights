<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Main SoundRights</title>
  <link rel="stylesheet" href="/login.css">
</head>
<body>
  <h2 id="welcome-message">Bienvenido</h2>
  <button id="goChat">Chatear con Usuario 2</button>
  <button id="logoutBtn">Cerrar sesión</button>
  <script>
    // Verifica sesión y muestra el nombre real
    fetch('/me', { credentials: 'include' })
      .then(res => res.json())
      .then(data => {
        if (data.success && data.user) {
          document.getElementById('welcome-message').textContent =
            `¡Bienvenido, ${data.user.name_user}!`;
        } else {
          window.location.href = '/login';
        }
      });

    document.getElementById('goChat').addEventListener('click', function() {
      // Redirige al chat con el usuario 2
      window.location.href = `/chat?receiver=2`;
    });

    document.getElementById('logoutBtn').onclick = async () => {
      await fetch('/logout', { method: 'POST', credentials: 'include' });
      window.location.href = '/login';
    };
  </script>
</body>
</html>